webpackJsonp([14],{"3hUo":function(t,e,r){var a=r("VU/8")(r("CHsu"),r("Y8TY"),!1,function(t){r("YPPn")},"data-v-11422860",null);t.exports=a.exports},CHsu:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},o=r("WmUf"),l=(a=o)&&a.__esModule?a:{default:a},n=r("em5V"),i=r("NYxO");e.default={data:function(){return{type:{approvers:[{id:""}],parent_id:[],name:"",describe:"",disabled:"",date_unique:!0},status:!0,props:{value:"id",label:"name"},roles:[]}},created:function(){var t=this;axios.get(l.default.api.roles).then(function(e){t.roles=e.data.data})},computed:s({},(0,i.mapState)(["types"])),methods:s({submitForm:function(t){var e=this;this.type.disabled=!this.status,axios.post(l.default.api.type,this.type).then(function(t){toastr.success(e.$t("el.notification.create_type")),e.SET_TYPES(t.data),e.$router.push("/system-types")},function(t){422==t.response.status?(0,n.stack_error)(t.response.data):toastr.error(t.response.status+" : Resource "+t.response.statusText)})},resetForm:function(t){this.$refs[t].resetFields(),this.change()},removeApprover:function(t){var e=this.type.approvers.indexOf(t);-1!==e&&(this.type.approvers.splice(e,1),this.change())},addApprover:function(){this.type.approvers.push({id:"",key:Date.now()})},change:function(t){var e=[];this.type.approvers.forEach(function(t){""!=t.id&&e.push(t.id)}),this.roles.forEach(function(t,r,a){for(var s=0;s<e.length;s++)if(t.id==e[s])return void(t.disabled=!0);t.disabled=!1})}},(0,i.mapMutations)(["SET_TYPES"]))}},Y8TY:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("vue-form",{attrs:{title:t.$t("el.form.create_type")}},[r("div",{attrs:{slot:"buttons"},slot:"buttons"},[r("router-link",{staticClass:"btn btn-default",attrs:{to:"/system-types",exact:""}},[t._v(t._s(t.$t("el.form.back")))])],1),t._v(" "),r("div",{attrs:{slot:"content"},slot:"content"},[r("div",{staticClass:"row"},[r("el-form",{ref:"type",staticClass:"col-md-4 col-md-offset-4",attrs:{model:t.type,"label-position":"top","label-width":"125px"}},[r("el-row",{attrs:{gutter:20}},[r("el-form-item",{attrs:{label:"parentId",prop:"parent_id"}},[r("el-cascader",{attrs:{placeholder:"Root",options:t.types,filterable:"","change-on-select":"",props:t.props,clearable:!0},model:{value:t.type.parent_id,callback:function(e){t.$set(t.type,"parent_id",e)},expression:"type.parent_id"}})],1)],1),t._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-form-item",{attrs:{label:t.$t("el.form.type_name"),prop:"name"}},[r("el-input",{attrs:{name:"name",placeholder:t.$t("el.form.type_name")},model:{value:t.type.name,callback:function(e){t.$set(t.type,"name",e)},expression:"type.name"}})],1)],1),t._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-form-item",{attrs:{label:t.$t("el.form.description"),prop:"describe"}},[r("el-input",{attrs:{type:"textarea",autosize:"",placeholder:t.$t("el.form.description")},model:{value:t.type.describe,callback:function(e){t.$set(t.type,"describe",e)},expression:"type.describe"}})],1)],1),t._v(" "),r("el-row",{attrs:{gutter:20}},t._l(t.type.approvers,function(e,a){return r("el-form-item",{key:e.key,staticClass:"form-inline",attrs:{label:t.$t("el.form.approver")+(a+1),prop:"approvers."+a+".id"}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:18}},[r("el-select",{staticStyle:{"padding-left":"0",width:"100%"},attrs:{filterable:"",placeholder:t.$t("el.form.approver_select")},on:{change:t.change},model:{value:e.id,callback:function(r){t.$set(e,"id",r)},expression:"approver.id"}},t._l(t.roles,function(t){return r("el-option",{key:t.id,attrs:{label:t.display_name,value:t.id,disabled:t.disabled}})}))],1),t._v(" "),r("el-col",{attrs:{span:6}},[r("el-button",{staticStyle:{padding:"10px"},on:{click:function(r){r.preventDefault(),t.removeApprover(e)}}},[t._v(t._s(t.$t("el.form.delete")))])],1)],1)],1)})),t._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:t.$t("el.form.is_enable")}},[r("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{prop:"date_unique",label:"唯一时间段"}},[r("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:t.type.date_unique,callback:function(e){t.$set(t.type,"date_unique",e)},expression:"type.date_unique"}})],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-form-item",[r("el-row",{attrs:{gutter:10}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("type")}}},[t._v(t._s(t.$t("el.form.submit")))]),t._v(" "),r("el-button",{on:{click:t.addApprover}},[t._v(t._s(t.$t("el.form.add_approver")))]),t._v(" "),r("el-button",{on:{click:function(e){t.resetForm("type")}}},[t._v(t._s(t.$t("el.form.reset")))])],1)],1)],1)],1),t._v(" "),r("div")],1)])])},staticRenderFns:[]}},YPPn:function(t,e,r){var a=r("ceHt");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r("rjj0")("3940debe",a,!0,{})},ceHt:function(t,e,r){(t.exports=r("FZ+f")(!1)).push([t.i,".el-input[data-v-11422860]{width:80%;margin-right:10px}",""])},em5V:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.stack_error=function(t){var e="";Object.keys(t).map(function(r,a){var s=t[r];e+='<span style="color: #e74c3c">'+s[0]+"</span><br>"}),swal({title:"Error Text!",type:"error",text:e,html:!0})}}});