webpackJsonp([13],{"0dOc":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("vue-form",{attrs:{title:t.$t("el.form.create_type")}},[s("div",{attrs:{slot:"buttons"},slot:"buttons"},[s("router-link",{staticClass:"btn btn-default",attrs:{to:"/system-types",exact:""}},[t._v(t._s(t.$t("el.form.back")))])],1),t._v(" "),s("div",{attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"row"},[s("el-form",{ref:"type",staticClass:"col-md-4 col-md-offset-4",attrs:{model:t.type,"label-position":"top","label-width":"100px"}},[s("el-form-item",{attrs:{label:t.$t("el.form.type_name"),prop:"name"}},[s("el-input",{attrs:{placeholder:t.$t("el.form.type_name")},model:{value:t.type.name,callback:function(e){t.$set(t.type,"name",e)},expression:"type.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:t.$t("el.form.description"),prop:"describe"}},[s("el-input",{attrs:{type:"textarea",autosize:"",placeholder:t.$t("el.form.description")},model:{value:t.type.describe,callback:function(e){t.$set(t.type,"describe",e)},expression:"type.describe"}})],1),t._v(" "),t.type.roles?t._l(t.type.roles.data,function(e,r){return s("el-form-item",{key:e.name,attrs:{label:t.$t("el.form.approver")+(r+1),prop:"roles.data."+r+".id"}},[s("el-select",{attrs:{filterable:"",placeholder:t.$t("el.form.approver_select")},on:{change:t.change},model:{value:e.id,callback:function(s){t.$set(e,"id",s)},expression:"approver.id"}},t._l(t.roles,function(t){return s("el-option",{key:t.id,attrs:{label:t.display_name,value:t.id,disabled:t.disabled}})})),t._v(" "),s("el-button",{staticStyle:{padding:"10px"},on:{click:function(s){s.preventDefault(),t.removeApprover(e)}}},[t._v(t._s(t.$t("el.form.delete")))])],1)}):t._e(),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:t.$t("el.form.is_enable")}},[s("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{prop:"date_unique",label:"唯一时间段"}},[s("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:t.type.date_unique,callback:function(e){t.$set(t.type,"date_unique",e)},expression:"type.date_unique"}})],1)],1)],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("type")}}},[t._v(t._s(t.$t("el.form.submit")))]),t._v(" "),s("el-button",{on:{click:t.addApprover}},[t._v(t._s(t.$t("el.form.add_approver")))])],1)],2)],1)])])},staticRenderFns:[]}},J0U6:function(t,e,s){var r=s("VU/8")(s("zf6v"),s("0dOc"),!1,function(t){s("iNos")},null,null);t.exports=r.exports},XnOW:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,"",""])},em5V:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.stack_error=function(t){var e="";Object.keys(t).map(function(s,r){var a=t[s];e+='<span style="color: #e74c3c">'+a[0]+"</span><br>"}),swal({title:"Error Text!",type:"error",text:e,html:!0})}},iNos:function(t,e,s){var r=s("XnOW");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);s("rjj0")("c6b045a6",r,!0,{})},zf6v:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},o=s("em5V"),n=s("WmUf"),i=(r=n)&&r.__esModule?r:{default:r},l=s("NYxO");e.default={data:function(){return{type:{},roles:[],status:!0}},created:function(){var t=this;axios.all([this.getRole(),this.gettype()]).then(axios.spread(function(e,s){t.roles=e.data.data,t.type=s.data.data,t.status=!t.type.disabled}))},computed:a({},(0,l.mapState)(["types"])),methods:{getRole:function(){return axios.get(i.default.api.roles)},gettype:function(){return axios.get(i.default.api.type+"/"+this.$route.params.id+"/edit?include=roles")},submitForm:function(t){var e=this;this.rolesId(),this.type.disabled=!this.status,axios.put(i.default.api.type+"/"+this.$route.params.id,this.type).then(function(t){toastr.success(e.$t("el.notification.update_type")),e.$router.push("/system-types")},function(t){422==t.response.status?(0,o.stack_error)(t.response.data):toastr.error(t.response.status+" : Resource "+t.response.statusText)})},resetForm:function(t){this.$refs[t].resetFields(),this.change()},removeApprover:function(t){var e=this.type.roles.data.indexOf(t);-1!==e&&(this.type.roles.data.splice(e,1),this.change())},addApprover:function(){this.type.roles.data.push({id:"",name:Date.now()})},change:function(t){var e=[];this.type.roles.data.forEach(function(t){""!=t.value&&e.push(t.value)}),this.roles.forEach(function(t,s,r){for(var a=0;a<e.length;a++)if(t.id==e[a])return void(t.disabled=!0);t.disabled=!1})},parentPath:function(t,e){e.forEach(function(s){s.id==t?(s.parent_id&&this.type.push(this.parentPath(s.id)),this.type.push(s.id)):e.children&&this.parentPath(t,e.children)})},rolesId:function(){for(var t=[],e=0;e<this.type.roles.data.length;e++)t.push(this.type.roles.data[e].id);this.type.approvers=t,console.log(this.type.approvers)}}}}});