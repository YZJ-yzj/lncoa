webpackJsonp([21],{AKQb:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,o=s("2WXv"),l=(a=o)&&a.__esModule?a:{default:a};e.default={components:{Modal:l.default},data:function(){return{folder:"",files:null,file_name:"",path:"",upload:{},showFolder:!1,showFile:!1,showImage:!1,preview_image:"",fields:[{name:"name",title:"ID",titleClass:"text-center",dataClass:"text-center"},{name:"user",title:"User Name",titleClass:"text-center",dataClass:"text-center",callback:"username"},{name:"title",title:"Title"},{name:"content",title:"Content",callback:"content"},{name:"status",title:"Status",titleClass:"text-center",dataClass:"text-center",callback:"status"},{name:"created_at",title:"Created At"},{name:"__actions",dataClass:"text-center"}]}},mounted:function(){this.getFileInfo(this.$route.query.folder)},methods:{preview:function(t){this.showImage=!0,this.preview_image=t},confirm:function(){var t=this;if(this.folder){var e="/"==this.upload.folder?"":this.upload.folder;this.path=e+"/"+this.folder,axios.post("/api/folder",{folder:this.path}).then(function(e){toastr.success("You create a new folder success!"),t.showFolder=!1,t.$set(t.upload.subfolders,t.path,t.folder),t.folder=""},function(t){toastr.error(t.response.status+" : "+t.response.statusText)})}else toastr.error("The folder name must be required!")},change:function(t){this.files=t.target.files.length?t.target.files:""},uploadFile:function(){var t=this;if(this.files){var e=new FormData;e.append("file",this.files[0]),e.append("name",this.file_name),e.append("folder",this.upload.folder),axios.post("/api/upload",e).then(function(e){toastr.success("You upload a file success!"),t.upload.files.push(e.data),t.file_name="",t.showFile=!1},function(t){t.response.data.error?toastr.error(t.response.data.error.message):toastr.error(t.response.status+" : Resource "+t.response.statusText)})}else toastr.error("The file must be required")},deleteFolder:function(t){var e=this,s="/"==this.upload.folder?"":this.upload.folder;axios.post("/api/folder/delete",{del_folder:t,folder:this.upload.folder}).then(function(a){toastr.success("You delete a folder success!"),e.$delete(e.upload.subfolders,s+"/"+t)},function(t){toastr.error(t.response.status+" : Resource "+t.response.statusText)})},deleteFile:function(t,e){var s=this;axios.post("/api/file/delete",{path:t.fullPath}).then(function(t){toastr.success("You delete a file success!"),s.upload.files.splice(e,1)},function(t){toastr.error(t.status+" : Resource "+t.statusText)})},getFileInfo:function(t){var e=this,s="/api/upload";t?s=s+"?folder="+t:t="/",axios.get(s).then(function(s){console.log(s),e.upload=s.data.data,e.upload.subfolders instanceof Array&&(e.upload.subfolders={}),e.$router.push(e.$route.path+"?folder="+t)})},checkImageType:function(t){return""!=t&&"image"==t.split("/")[0]}}}},HrKz:function(t,e,s){var a=s("NI4L");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);s("rjj0")("90fe3a60",a,!0,{})},NI4L:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,".box-body button[data-v-3a6c47f3],.box-body button[data-v-3a6c47f3]:hover{padding:0;border-radius:50%;width:2.5em;height:2.5em;outline:none}.preview-size[data-v-3a6c47f3]{max-width:500px}@media (max-width:768px){.preview-size[data-v-3a6c47f3]{max-width:250px}}input[type=file][data-v-3a6c47f3]{display:block}",""])},jtgQ:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row"},[s("div",{staticClass:"ibox"},[s("div",{staticClass:"ibox-title"},[s("div",{staticClass:"row no-margin"},[s("div",{staticClass:"col-md-6"},[s("h4",{staticClass:"pull-left"},[t._v(t._s(t.$t("el.page.files"))+"  ")]),t._v(" "),s("div",{staticClass:"pull-left"},[s("ul",{staticClass:"breadcrumb"},[t._l(t.upload.breadcrumbs,function(e,a){return s("li",[s("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.getFileInfo(a)}}},[t._v("\n                                    "+t._s(e)+"\n                                ")])])}),t._v(" "),s("li",{staticClass:"active"},[t._v(t._s(t.upload.folderName))])],2)])]),t._v(" "),s("div",{staticClass:"col-md-6"},[s("small",{staticClass:"pull-right",staticStyle:{"margin-top":"7px"}},[s("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"button"},on:{click:function(e){t.showFolder=!0}}},[s("i",{staticClass:"ion-ios-plus"}),t._v(" "+t._s(t.$t("el.table.new_folder"))+"\n                        ")]),t._v(" "),s("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:function(e){t.showFile=!0}}},[s("i",{staticClass:"ion-ios-filing-outline"}),t._v(" "+t._s(t.$t("el.table.upload"))+"\n                        ")])])])])]),t._v(" "),s("div",{staticClass:"ibox-content table-responsive no-padding"},[s("table",{staticClass:"table table-striped table-hover",attrs:{id:"uploads-table"}},[s("tbody",[s("tr",[s("th",[t._v(t._s(t.$t("el.table.name")))]),t._v(" "),s("th",[t._v(t._s(t.$t("el.table.type")))]),t._v(" "),s("th",[t._v(t._s(t.$t("el.table.date")))]),t._v(" "),s("th",[t._v(t._s(t.$t("el.table.size")))]),t._v(" "),s("th",[t._v(t._s(t.$t("el.table.action")))])]),t._v(" "),t._l(t.upload.subfolders,function(e,a){return s("tr",[s("td",[s("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.getFileInfo(a)}}},[s("i",{staticClass:"ion-filing"}),t._v("\n                            "+t._s(e)+"\n                        ")])]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[t._v("-")]),t._v(" "),s("td",[s("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(s){t.deleteFolder(e)}}},[s("i",{staticClass:"ion-trash-b"})])])])}),t._v(" "),t._l(t.upload.files,function(e,a){return s("tr",[s("td",[s("a",{attrs:{target:"_blank",href:e.webPath}},[e.mimeType&&t.checkImageType(e.mimeType)?s("i",{staticClass:"ion-image"}):s("i",{staticClass:"ion-document-text"}),t._v("\n                            "+t._s(e.name)+"\n                        ")])]),t._v(" "),s("td",[t._v(t._s(e.mimeType))]),t._v(" "),s("td",[t._v(t._s(e.modified))]),t._v(" "),s("td",[t._v(t._s(e.size))]),t._v(" "),s("td",[e.mimeType&&t.checkImageType(e.mimeType)?s("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:function(s){t.preview(e.webPath)}}},[s("i",{staticClass:"ion-eye"})]):t._e(),t._v(" "),s("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(s){t.deleteFile(e,a)}}},[s("i",{staticClass:"ion-trash-b"})])])])})],2)])])]),t._v(" "),s("modal",{attrs:{show:t.showFolder,"show-footer":""},on:{confirm:t.confirm,cancel:function(e){t.showFolder=!1}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("el.form.create_folder")))]),t._v(" "),s("form",{staticClass:"form-horizontal",attrs:{role:"form"}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label col-sm-3",attrs:{for:"folder"}},[t._v(t._s(t.$t("el.form.folder_name")))]),t._v(" "),s("div",{staticClass:"col-sm-8"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.folder,expression:"folder"}],staticClass:"form-control",attrs:{type:"text",id:"folder",placeholder:t.$t("el.form.folder_name")},domProps:{value:t.folder},on:{input:function(e){e.target.composing||(t.folder=e.target.value)}}})])])])]),t._v(" "),s("modal",{attrs:{show:t.showFile,"show-footer":""},on:{confirm:t.uploadFile,cancel:function(e){t.showFile=!1}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("el.form.upload_file")))]),t._v(" "),s("form",{staticClass:"form-horizontal",attrs:{role:"form",enctype:"multipart/form-data"}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label col-sm-3",attrs:{for:"file"}},[t._v(t._s(t.$t("el.form.file")))]),t._v(" "),s("div",{staticClass:"col-sm-8"},[s("input",{staticClass:"form-control",attrs:{type:"file",id:"file",name:"file"},on:{change:t.change}})])]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label col-sm-3",attrs:{for:"file_name"}},[t._v(t._s(t.$t("el.form.file_name")))]),t._v(" "),s("div",{staticClass:"col-sm-8"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.file_name,expression:"file_name"}],staticClass:"form-control",attrs:{type:"text",id:"file_name",name:"file_name",placeholder:t.$t("el.form.file_name")},domProps:{value:t.file_name},on:{input:function(e){e.target.composing||(t.file_name=e.target.value)}}})])])])]),t._v(" "),s("modal",{attrs:{show:t.showImage},on:{confirm:t.confirm,cancel:function(e){t.showImage=!1}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("el.form.image")))]),t._v(" "),s("form",{staticClass:"form-horizontal",attrs:{role:"form"}},[s("div",{staticClass:"form-group"},[s("div",{staticClass:"col-sm-12 text-center"},[s("img",{staticClass:"preview-size",attrs:{src:t.preview_image}})])])])])],1)},staticRenderFns:[]}},zqu3:function(t,e,s){var a=s("VU/8")(s("AKQb"),s("jtgQ"),!1,function(t){s("HrKz")},"data-v-3a6c47f3",null);t.exports=a.exports}});