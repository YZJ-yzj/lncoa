webpackJsonp([26],{"4QcX":function(a,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r=Object.assign||function(a){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r])}return a},t=e("em5V"),i=e("sUu7");s.default={data:function(){return{disabled:!1}},created:function(){this.$validator.rules.email_unique||i.Validator.extend("email_unique",{getMessage:function(a){return"该"+a+"已被使用."},validate:function(a){return new Promise(function(s){axios.get("/api/register/email/check?email="+a).then(function(a){return s({valid:a.data.success})})})}}),this.$validator.rules.name_unique||i.Validator.extend("name_unique",{getMessage:function(a){return"该"+a+"已被使用."},validate:function(a){return new Promise(function(s){axios.get("/api/register/name/check?name="+a).then(function(a){return s({valid:a.data.success})})})}}),this.$validator.updateDictionary({zh_CN:{attributes:{name:"用户名",email:"邮箱",password:"密码",password_confirmation:"确认密码"}}})},computed:r({},(0,i.mapFields)({nameFlags:"name",emailFlags:"email",passwordFlags:"password",passwordConfirmationFlags:"password_confirmation"}),{formDirty:function(){var a=this;return Object.keys(this.validataFields).some(function(s){return a.validataFields[s].dirty})}}),methods:{validateBeforeSubmit:function(a){var s=this;s.$validator.validateAll().then(function(){s.create(a)}).catch(function(){toastr.error(s.$t("el.notification.submit_data_error"))})},create:function(a){var s=this,e=new FormData(a.target);this.disabled=!0,axios.post("/api/user",e).then(function(a){toastr.success(s.$t("el.notification.create_user")),s.$router.push("/users")},function(a){s.disabled=!1,422==a.response.status?(0,t.stack_error)(a.response.data):toastr.error(a.response.status+" : Resource "+a.response.statusText)})}}}},b4yz:function(a,s){a.exports={render:function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("vue-form",{attrs:{title:a.$t("el.form.create_user")}},[e("div",{attrs:{slot:"buttons"},slot:"buttons"},[e("router-link",{staticClass:"btn btn-default",attrs:{to:"/users",exact:""}},[a._v(a._s(a.$t("el.form.back")))])],1),a._v(" "),e("div",{attrs:{slot:"content"},slot:"content"},[e("div",{staticClass:"row"},[e("form",{staticClass:"form col-md-4 col-md-offset-4",attrs:{role:"form"},on:{submit:function(s){return s.preventDefault(),a.validateBeforeSubmit(s)}}},[e("div",{staticClass:"form-group has-feedback",class:{"has-error":a.nameFlags.invalid,"has-success":a.nameFlags.valid}},[e("label",{attrs:{for:"name"}},[a._v(a._s(a.$t("el.form.name")))]),a._v(" "),e("input",{directives:[{name:"validate",rawName:"v-validate",value:{rules:{required:!0,regex:/^[\u4e00-\u9fa5_a-zA-Z0-9-]{2,16}$/,name_unique:!0}},expression:"{  rules: {required: true, regex: /^[\\u4e00-\\u9fa5_a-zA-Z0-9-]{2,16}$/, name_unique:true} }"}],staticClass:"form-control",attrs:{name:"name","data-vv-delay":"500",type:"text",id:"name",placeholder:a.$t("el.form.name")}}),a._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:a.nameFlags.dirty||a.nameFlags.invalid,expression:"nameFlags.dirty || nameFlags.invalid"}],staticClass:"glyphicon form-control-feedback",class:{"glyphicon-warning-sign":a.nameFlags.invalid,"glyphicon-ok":a.nameFlags.valid}}),a._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:a.errors.has("name"),expression:"errors.has('name')"}],staticClass:"help-block"},[e("strong",[a._v(a._s(a.errors.first("name")))])])]),a._v(" "),e("div",{staticClass:"form-group has-feedback",class:{"has-error":a.emailFlags.invalid,"has-success":a.emailFlags.valid}},[e("label",{attrs:{for:"email"}},[a._v(a._s(a.$t("el.form.email")))]),a._v(" "),e("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|email|email_unique",expression:"'required|email|email_unique'"}],staticClass:"form-control",attrs:{name:"email","data-vv-delay":"1",type:"email",id:"email",placeholder:a.$t("el.form.email")}}),a._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:a.emailFlags.dirty||a.emailFlags.invalid,expression:"emailFlags.dirty || emailFlags.invalid"}],staticClass:"glyphicon form-control-feedback",class:{"glyphicon-warning-sign":a.emailFlags.invalid,"glyphicon-ok":a.emailFlags.valid}}),a._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:a.errors.has("email"),expression:"errors.has('email')"}],staticClass:"help-block"},[e("strong",[a._v(a._s(a.errors.first("email")))])])]),a._v(" "),e("div",{staticClass:"form-group has-feedback",class:{"has-error":a.passwordFlags.invalid,"has-success":a.passwordFlags.valid}},[e("label",{attrs:{for:"password"}},[a._v(a._s(a.$t("el.form.password")))]),a._v(" "),e("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|min:6|max:16",expression:"'required|min:6|max:16'"}],staticClass:"form-control",attrs:{name:"password","data-vv-delay":"500",type:"password",id:"password",placeholder:a.$t("el.form.password")}}),a._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:a.passwordFlags.dirty||a.passwordFlags.invalid,expression:"passwordFlags.dirty || passwordFlags.invalid"}],staticClass:"glyphicon form-control-feedback",class:{"glyphicon-warning-sign":a.passwordFlags.invalid,"glyphicon-ok":a.passwordFlags.valid}}),a._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:a.errors.has("password"),expression:"errors.has('password')"}],staticClass:"help-block"},[e("strong",[a._v(a._s(a.errors.first("password")))])])]),a._v(" "),e("div",{staticClass:"form-group has-feedback",class:{"has-error":a.passwordConfirmationFlags.invalid,"has-success":a.passwordConfirmationFlags.valid}},[e("label",{attrs:{for:"password_confirmation"}},[a._v(a._s(a.$t("el.form.confirm_password")))]),a._v(" "),e("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|confirmed:password",expression:"'required|confirmed:password'"}],staticClass:"form-control",attrs:{name:"password_confirmation",type:"password",id:"password_confirmation",placeholder:a.$t("el.form.confirm_password")}}),a._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:a.passwordConfirmationFlags.dirty||a.passwordConfirmationFlags.invalid,expression:"passwordConfirmationFlags.dirty || passwordConfirmationFlags.invalid"}],staticClass:"glyphicon form-control-feedback",class:{"glyphicon-warning-sign":a.passwordConfirmationFlags.invalid,"glyphicon-ok":a.passwordConfirmationFlags.valid}}),a._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:a.errors.has("password_confirmation"),expression:"errors.has('password_confirmation')"}],staticClass:"help-block"},[e("strong",[a._v(a._s(a.errors.first("password_confirmation")))])])]),a._v(" "),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:!a.formDirty||a.disabled}},[a._v(a._s(a.$t("el.form.create")))])])])])])])},staticRenderFns:[]}},dkkr:function(a,s,e){var r=e("VU/8")(e("4QcX"),e("b4yz"),!1,null,null,null);a.exports=r.exports},em5V:function(a,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.stack_error=function(a){var s="";Object.keys(a).map(function(e,r){var t=a[e];s+='<span style="color: #e74c3c">'+t[0]+"</span><br>"}),swal({title:"Error Text!",type:"error",text:s,html:!0})}}});