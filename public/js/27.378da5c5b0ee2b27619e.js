webpackJsonp([27],{"6FwY":function(e,t,s){var r=s("VU/8")(s("AO/E"),s("x37X"),!1,null,null,null);e.exports=r.exports},"AO/E":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{user:{},roles:{},user_role:[],oldCheckList:{},dialogFormVisible:!1,formLabelWidth:"120px"}},created:function(){var e=this;axios.all([this.getUserInfo(),this.getRoles()]).then(axios.spread(function(t,s){e.user=t.data.data,t.data.data.roles.data.forEach(function(t){e.user_role.push(t.display_name)}),e.roles=s.data.data}))},methods:{edit:function(){var e=this;this.updateUserRoleValue(),axios.put("/api/user/"+this.$route.params.id+"?include=roles",this.user).then(function(t){toastr.success(e.$t("el.notification.update_user")),e.$router.push("/users")},function(e){toastr.error(e.response.status+" : Resource "+e.response.statusText)})},getUserInfo:function(){return axios.get("/api/user/"+this.$route.params.id+"/edit?include=roles")},getRoles:function(){return axios.get("/api/role")},openRole:function(){this.oldCheckList=this.user_role,this.dialogFormVisible=!0},cancel:function(){this.user_role=this.oldCheckList,this.dialogFormVisible=!1},updateUserRoleValue:function(){var e=[],t=this;t.roles.forEach(function(s){t.user_role.indexOf(s.display_name)>-1&&e.push(s.id)}),t.user.roles=e}}}},x37X:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("vue-form",{attrs:{title:e.$t("el.form.edit_user")}},[s("div",{attrs:{slot:"buttons"},slot:"buttons"},[s("router-link",{staticClass:"btn btn-default",attrs:{to:"/users",exact:""}},[e._v(e._s(e.$t("el.form.back")))])],1),e._v(" "),s("div",{attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"row"},[s("form",{staticClass:"form col-md-4 col-md-offset-4",attrs:{role:"form"},on:{submit:function(t){return t.preventDefault(),e.edit(t)}}},[s("div",{staticClass:"form-group text-center"},[s("img",{staticClass:"img-circle",attrs:{src:e.user.avatar?e.user.avatar:"http://lncoa.app/images/default.png",id:"avatar",width:"100",alt:e.user.name}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[e._v(e._s(e.$t("el.form.name")))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],staticClass:"form-control",attrs:{type:"text",id:"name",placeholder:e.$t("el.form.name"),disabled:""},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[e._v(e._s(e.$t("el.form.email")))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],staticClass:"form-control",attrs:{type:"email",id:"email",placeholder:e.$t("el.form.email"),disabled:""},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"nickname"}},[e._v(e._s(e.$t("el.form.nickname")))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.nickname,expression:"user.nickname"}],staticClass:"form-control",attrs:{type:"text",id:"nickname",placeholder:e.$t("el.form.nickname")},domProps:{value:e.user.nickname},on:{input:function(t){t.target.composing||e.$set(e.user,"nickname",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"description"}},[e._v(e._s(e.$t("el.form.description")))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.description,expression:"user.description"}],staticClass:"form-control",attrs:{type:"text",id:"description",placeholder:e.$t("el.form.description")},domProps:{value:e.user.description},on:{input:function(t){t.target.composing||e.$set(e.user,"description",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password"}},[e._v(e._s(e.$t("el.form.password")))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],staticClass:"form-control",attrs:{type:"password",id:"password",placeholder:e.$t("el.form.password")},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"role"}},[e._v(e._s(e.$t("el.table.role")))]),e._v(" "),s("div",{attrs:{id:"role"}},[e._l(e.user_role,function(t){return s("el-tag",{key:t.id,staticStyle:{"margin-right":"5px"}},[e._v(e._s(t))])}),e._v(" "),s("i",{staticClass:"el-icon-edit",on:{click:e.openRole}})],2)]),e._v(" "),s("el-dialog",{attrs:{title:"设置角色"},model:{value:e.dialogFormVisible,callback:function(t){e.dialogFormVisible=t},expression:"dialogFormVisible"}},[s("el-checkbox-group",{model:{value:e.user_role,callback:function(t){e.user_role=t},expression:"user_role"}},e._l(e.roles,function(e){return s("el-checkbox",{key:e.id,attrs:{label:e.display_name,data:e.id}})})),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("el.form.cancel")))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("el.form.ok")))])],1)],1),e._v(" "),s("div",{staticClass:"form-group"},[s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v(e._s(e.$t("el.form.edit")))])])],1)])])])},staticRenderFns:[]}}});